{%- liquid
  assign menu_title = menu_title | default: link.title | strip
  assign menu_title_upcase = menu_title | upcase

  assign is_shop_menu = false
  if menu_title_upcase == 'SHOP'
    assign is_shop_menu = true
  endif

  assign is_scents_menu = false
  if menu_title_upcase == 'SCENTS'
    assign is_scents_menu = true
  endif

  assign eyebrow_text = ''
  if is_shop_menu
    assign eyebrow_text = 'Shop by format'
  elsif is_scents_menu
    assign eyebrow_text = 'Explore our Fragrance Library'
  endif

  assign featured_block = blank
  for nav_block in section.blocks
    assign promo_item_upcase = nav_block.settings.mega_promotion_item | strip | upcase
    if nav_block.type == 'mega_promotion' and promo_item_upcase == menu_title_upcase
      assign featured_block = nav_block
      break
    endif
  endfor
-%}

<div
  id="MegaMenu-Content-{{ menu_index }}"
  class="navigation-submenu top mega-menu__content cbv-mega-menu color-{{ section.settings.color_scheme }} gradient motion-reduce global-settings-popup"
  tabindex="-1"
>
  <div class="cbv-mega-menu__inner">
    
    <div class="cbv-mega-menu__main">
      {%- if eyebrow_text != blank -%}
        <span class="cbv-mega-menu__eyebrow">{{ eyebrow_text }}</span>
      {%- endif -%}

      <ul class="cbv-mega-menu__columns {% if is_scents_menu %}cbv-mega-menu__columns--scents{% endif %}" role="list">
        {%- case menu_title_upcase -%}
          {%- when 'SHOP' -%}
            <li class="cbv-mega-menu__column animate-fade-up">
              <a href="#" class="heading-bold link">Candles</a>
              <ul class="cbv-mega-menu__sublist list-unstyled" role="list">
                
                <li>
                  <a href="#" class="mega-menu__link heading-bold" style="font-weight: 600;">
                    Best Sellers <span class="cbv-menu-badge cbv-menu-badge--highlight">Hot</span>
                  </a>
                </li>
                
                <li>
                  <span class="mega-menu__link--level-2">Shop by Size</span>
                  <ul class="cbv-spec-list list-unstyled" role="list">
                    <li>
                      <a href="#" class="mega-menu__link">
                        <span>15oz Wickless</span>
                        <span class="cbv-spec-meta">Flameless</span>
                      </a>
                    </li>
                    <li>
                      <a href="#" class="mega-menu__link">
                        <span>18oz Large</span>
                        <span class="cbv-spec-meta">
                          {% render 'icon-fire-small' %} 1-Wick
                        </span>
                      </a>
                    </li>
                    <li>
                      <a href="#" class="mega-menu__link">
                        <span>30oz Victorian</span>
                        <span class="cbv-spec-meta">
                           {% render 'icon-fire-small' %} 3-Wick
                        </span>
                      </a>
                    </li>
                    <li>
                      <a href="#" class="mega-menu__link">
                        <span>70oz 5-Wick</span>
                        <span class="cbv-spec-meta">
                           {% render 'icon-fire-small' %} 5-Wick
                        </span>
                      </a>
                    </li>
                  </ul>
                </li>
                
                <li><a href="#" class="mega-menu__link">Custom Pour</a></li>
                <li><a href="#" class="mega-menu__link">Seasonal Collection <span class="cbv-menu-badge">New</span></a></li>
              </ul>
            </li>
            <li class="cbv-mega-menu__column animate-fade-up">
              <a href="#" class="heading-bold link">Wax Melts</a>
              <ul class="cbv-mega-menu__sublist list-unstyled" role="list">
                <li><a href="#" class="mega-menu__link">Break-Away Melts</a></li>
                <li><a href="#" class="mega-menu__link">Cube Melts</a></li>
                <li><a href="#" class="mega-menu__link">Create Your Own</a></li>
              </ul>
            </li>
            <li class="cbv-mega-menu__column animate-fade-up">
              <a href="#" class="heading-bold link">Scent Shots</a>
              <ul class="cbv-mega-menu__sublist list-unstyled" role="list">
                <li><a href="#" class="mega-menu__link">Shop All</a></li>
                <li><a href="#" class="mega-menu__link">3-Pack Bundle</a></li>
                <li><a href="#" class="mega-menu__link">6-Pack Bundle</a></li>
                <li><a href="#" class="mega-menu__link">Custom Pack</a></li>
              </ul>
            </li>
            <li class="cbv-mega-menu__column animate-fade-up">
              <a href="#" class="heading-bold link">Gifts &amp; Specials</a>
              <ul class="cbv-mega-menu__sublist list-unstyled" role="list">
                <li><a href="#" class="mega-menu__link">Sampler Packs</a></li>
                <li><a href="#" class="mega-menu__link">Gift Cards</a></li>
                <li><a href="#" class="mega-menu__link">Limited Drops</a></li>
              </ul>
            </li>

          {%- when 'SCENTS' -%}
            {%- assign scent_links = 'Bakery/Gourmand|Christmas|Clean|Customer Creations|Earthy|Fall|Floral|Fruity|House Blends|Lush Dupes|Luxury Spa|Perfume & Cologne|Tropical|Best Sellers|All Scents (Aâ€“Z)|Search' | split: '|' -%}
            
            {%- for scent_link in scent_links -%}
              <li class="cbv-mega-menu__scent-item animate-fade-up">
                <a href="#" class="cbv-mega-menu__scent-tile">
                  {{ scent_link }}
                </a>
              </li>
            {%- endfor -%}

          {%- when 'BUNDLES' -%}
            <li class="cbv-mega-menu__column animate-fade-up">
               <a href="#" class="heading-bold link">Bundles</a>
               <ul class="cbv-mega-menu__sublist list-unstyled" role="list">
                  <li><a href="#" class="mega-menu__link">Sampler Packs</a></li>
                  <li><a href="#" class="mega-menu__link">Build Your Own Scent Shot Pack</a></li>
                  <li><a href="#" class="mega-menu__link">Build Your Own Melt Pack</a></li>
                  <li><a href="#" class="mega-menu__link">Category Boxes</a></li>
               </ul>
            </li>

          {%- when 'SUBSCRIBE & SAVE' -%}
             <li class="cbv-mega-menu__column animate-fade-up">
               <a href="#" class="heading-bold link">Subscription</a>
               <ul class="cbv-mega-menu__sublist list-unstyled" role="list">
                <li><a href="#" class="mega-menu__link">Program Overview</a></li>
                <li><a href="#" class="mega-menu__link">Subscription Bundles</a></li>
                <li><a href="#" class="mega-menu__link">Manage Subscription</a></li>
               </ul>
            </li>

          {%- when 'BEST SELLERS' -%}
             <li class="cbv-mega-menu__column animate-fade-up">
               <a href="#" class="heading-bold link">Top Rated</a>
               <ul class="cbv-mega-menu__sublist list-unstyled" role="list">
                <li><a href="#" class="mega-menu__link">Best Sellers (All)</a></li>
                <li><a href="#" class="mega-menu__link">Best Selling Candles</a></li>
                <li><a href="#" class="mega-menu__link">Best Selling Scent Shots</a></li>
                <li><a href="#" class="mega-menu__link">Best Selling Melts</a></li>
               </ul>
            </li>

          {%- when 'SEASONAL' -%}
             <li class="cbv-mega-menu__column animate-fade-up">
               <a href="#" class="heading-bold link">Currently Trending</a>
               <ul class="cbv-mega-menu__sublist list-unstyled" role="list">
                <li><a href="#" class="mega-menu__link">Seasonal Shop</a></li>
                <li><a href="#" class="mega-menu__link">Fall Collection</a></li>
                <li><a href="#" class="mega-menu__link">Christmas Collection</a></li>
                <li><a href="#" class="mega-menu__link">Limited Drops</a></li>
               </ul>
            </li>
        {%- endcase -%}
      </ul>
    </div>

    <aside class="cbv-mega-menu__feature" aria-label="Featured">
      <div class="cbv-mega-menu__feature-inner">
      {%- if is_scents_menu and section.settings.scents_search_link != blank -%}
        <a href="{{ section.settings.scents_search_link }}" class="cbv-mega-menu__search-card link focus-inset">
          <p class="cbv-mega-menu__search-title">{{ section.settings.scents_search_heading | escape }}</p>
          {%- if section.settings.scents_search_copy != blank -%}
            <p class="cbv-mega-menu__search-copy">{{ section.settings.scents_search_copy | escape }}</p>
          {%- endif -%}
          <span class="cbv-mega-menu__search-cta">{{ section.settings.scents_search_label | escape }}</span>
        </a>
      {%- endif -%}

      {%- if featured_block != blank -%}
        <div class="mega-menu-collection animate-fade-up" {{ featured_block.shopify_attributes }}>
          {%- if featured_block.settings.mega_promotion_image != blank -%}
            <div class="mega-menu-collection-image">
              <a href="{{ featured_block.settings.mega_promotion_link }}" class="title-link">
                {{ featured_block.settings.mega_promotion_image | image_url: width: 400 | image_tag: loading: 'lazy' }}
              </a>
            </div>
          {%- else -%}
             <div class="mega-menu-collection-image">
              {{ 'hero-apparel-2' | placeholder_svg_tag: 'placeholder-svg' }}
            </div>
          {%- endif -%}
          
          {%- if featured_block.settings.mega_promotion_title != blank -%}
            <p class="title heading-bold">{{ featured_block.settings.mega_promotion_title }}</p>
          {%- endif -%}

          {%- if featured_block.settings.mega_promotion_caption != blank -%}
            <div class="mega-menu-collection-text">
              <p class="caption-with-letter-spacing">{{ featured_block.settings.mega_promotion_caption | escape }}</p>
            </div>
          {%- endif -%}
          {%- if featured_block.settings.mega_promotion_link_label != blank -%}
            <div class="mega-menu-link link">
              <a class="link animate-arrow" {% if featured_block.settings.mega_promotion_link == blank %}role="link" aria-disabled="true"{% else %}href="{{ featured_block.settings.mega_promotion_link }}"{% endif %}>
                {{ featured_block.settings.mega_promotion_link_label | escape }} <span class="icon-wrap">{% render 'icon-arrow' %}</span>
              </a>
            </div>
          {%- endif -%}
        </div>
      {%- endif -%}
      </div>
    </aside>
  </div>
</div>